import{a as O}from"./chunk-6VVBVPFE.js";import{a as M,b as j,c as B}from"./chunk-P6KFG34U.js";import"./chunk-KMUZPL3V.js";import"./chunk-VNWZKHP3.js";import{a as P}from"./chunk-KQUAVRFU.js";import"./chunk-WXWXYMIB.js";import{a as W}from"./chunk-C73HAMVH.js";import{k as E}from"./chunk-6WQU6EZD.js";import{k as I,l as T}from"./chunk-ISIAGV3U.js";import{Ab as p,Ib as c,Jb as C,Kb as k,Oa as w,Ra as s,Wa as l,_ as b,ab as S,ea as h,fa as g,fb as u,nb as m,tb as o,ub as r,vb as _,wb as f,xb as x,yb as y,zb as v}from"./chunk-7YWQNTIB.js";function V(a,t){a&1&&(f(0),c(1,"Add"),x())}function A(a,t){a&1&&(f(0),c(1,"Adding..."),x())}function R(a,t){if(a&1){let e=y();o(0,"div",4)(1,"div",5),_(2,"img",6),r(),o(3,"div",7)(4,"h3",8),c(5),r(),o(6,"h3"),c(7),r(),o(8,"div",9)(9,"h3"),c(10),r(),_(11,"div",10),r(),o(12,"div",11)(13,"button",12),v("click",function(){let n=h(e).$implicit,d=p();return g(d.remove(n._id))}),c(14,"DELETE"),r()()(),o(15,"div",13)(16,"button",14),v("click",function(n){let d=h(e).$implicit,D=p();return g(D.addToCart(d,n))}),u(17,V,2,0,"ng-container",15)(18,A,2,0,"ng-container",15),r(),o(19,"div",16)(20,"button",17),v("click",function(){let n=h(e).$implicit,d=p();return g(d.openDetails(n._id))}),c(21,"Details"),r()()()()}if(a&2){let e=t.$implicit,i=p();s(2),m("src",e.imageCover,w)("alt",e.title),s(3),C(e.category.name),s(2),C(e.title),s(3),k("",e.price," EGP"),s(6),m("disabled",i.loadingCart[e._id]),s(),m("ngIf",!i.loadingCart[e._id]),s(),m("ngIf",i.loadingCart[e._id])}}var F=class a{constructor(t,e,i,n,d){this.wishlist=t;this.cartService=e;this.auth=i;this.snackBar=n;this.r=d}products=[];cart=[];loadingCart={};loader=b(W);ngOnInit(){this.load(),this.loadCart()}trackById(t,e){return e._id}loadCart(){this.cartService.getCart().subscribe({next:t=>this.cart=t.products||[]})}addToCart(t,e){if(e.stopPropagation(),!this.auth.isLoggedIn()){this.r.navigate(["/login"]);return}if(this.loadingCart[t._id]=!0,this.cart.find(n=>n.product._id===t._id)){this.loadingCart[t._id]=!1,this.remove(t._id),this.showToast("Removed from wishlist","favorite_border");return}this.cartService.addCart(t._id).subscribe({next:n=>{this.cart.push({product:t,count:1,_id:n.data._id}),this.showToast("Added to cart!","shopping_cart"),this.loadingCart[t._id]=!1,this.remove(t._id),this.showToast("Removed from wishlist","favorite_border")},error:()=>this.loadingCart[t._id]=!1})}load(){this.loader.show(),this.wishlist.getWishlist().subscribe({next:t=>{this.products=t.data||[],this.loader.hide()},error:()=>this.loader.hide()})}remove(t){this.loader.show(),this.wishlist.removeFromWishlist(t).subscribe({next:()=>{this.products=this.products.filter(e=>e._id!==t),this.showToast("Removed from wishlist","delete"),this.loader.hide()},error:()=>this.loader.hide()}),this.load()}openDetails(t){this.r.navigate(["/products-details",t])}showToast(t,e="check_circle"){this.snackBar.openFromComponent(j,{data:{message:t,icon:e},duration:3e3,horizontalPosition:"right",verticalPosition:"top",panelClass:["custom-snackbar"]})}static \u0275fac=function(e){return new(e||a)(l(O),l(B),l(P),l(M),l(E))};static \u0275cmp=S({type:a,selectors:[["app-wishlist"]],decls:5,vars:2,consts:[[1,"m-3","pt-10"],[1,"text-green-500","text-2xl","p-5","m-5","text-center","align-middle","justify-center"],[1,"grid","grid-cols-2","justify-center","align-center","sm:grid-cols-2","md:grid-cols-3","lg:grid-cols-4"],["class","product m-3 p-4 gap-2",4,"ngFor","ngForOf","ngForTrackBy"],[1,"product","m-3","p-4","gap-2"],[1,"imgcont","align-center","justify-center","items-center"],[1,"h-1vh","lg:h-auto",3,"src","alt"],[1,"text","m-3"],[1,"text-main","category"],[1,"flex","flex-row","gap-5"],[1,"flex","flex-row","ml-auto","flex-end"],[1,"dl","flex","justify-center","align-center"],[1,"text-white","mt-3","mb-3","bg-red-600","rounded","p-2","hover:scale-1.5","hover:bg-red-800","max-w-48","cursor-pointer",3,"click"],[1,"flex","flex-row","gap-3"],[1,"btn","rounded-md","mx-auto",3,"click","disabled"],[4,"ngIf"],[1,"btn","mx-auto","rounded-md"],[3,"click"]],template:function(e,i){e&1&&(o(0,"section",0)(1,"h1",1),c(2,"Wishlist "),r(),o(3,"div",2),u(4,R,22,8,"div",3),r()()),e&2&&(s(4),m("ngForOf",i.products)("ngForTrackBy",i.trackById))},dependencies:[I,T],styles:[".imgcont[_ngcontent-%COMP%]{max-width:100%;overflow:hidden;display:flex;border-radius:40px}.imgcont[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{border-radius:40px;max-width:100%;max-height:100%;object-fit:contain}.star[_ngcontent-%COMP%]{color:#daa520}.category[_ngcontent-%COMP%]{color:var(--main-color);margin-bottom:10px}.btn[_ngcontent-%COMP%]{justify-content:center;align-items:center;text-align:center;background-color:#0aad0a;border-radius:10px;width:50%;padding:10px;cursor:pointer}.btn[_ngcontent-%COMP%]:hover{background-color:#098d09}"]})};export{F as WishlistComponent};
