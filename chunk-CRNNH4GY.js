import{a as h,b as l,c as u}from"./chunk-P6KFG34U.js";import{a as d}from"./chunk-KQUAVRFU.js";import{a as s}from"./chunk-WXWXYMIB.js";import{k as m}from"./chunk-6WQU6EZD.js";import{v as p}from"./chunk-ISIAGV3U.js";import{U as n,Z as a,k as c}from"./chunk-7YWQNTIB.js";var f=class i{constructor(t,r,o,e){this.cartService=t;this.auth=r;this.router=o;this.snackBar=e}loadingCart={};cart$=new c([]);showToast(t,r="check_circle"){this.snackBar.openFromComponent(l,{data:{message:t,icon:r},duration:3e3,horizontalPosition:"right",verticalPosition:"top",panelClass:["custom-snackbar"]})}getCartFromApi(){this.cartService.getCart().subscribe({next:t=>{this.cart$.next(t.products||[])},error:()=>{}})}addToCart(t){if(!this.auth.isLoggedIn()){this.router.navigate(["/login"]);return}this.loadingCart[t._id]=!0;let r=this.cart$.value,o=r.find(e=>e.product._id===t._id);if(o){let e=o.count+1;this.cartService.updateCart(t._id,e).subscribe({next:()=>{o.count=e,this.cart$.next([...r]),this.showToast("Added to cart!","shopping_cart"),this.loadingCart[t._id]=!1},error:()=>{this.loadingCart[t._id]=!1}})}else this.cartService.addCart(t._id).subscribe({next:e=>{let g=[...r,{product:t,count:1,_id:e.data._id}];this.cart$.next(g),this.showToast("Added to cart!","shopping_cart"),this.loadingCart[t._id]=!1},error:()=>{this.loadingCart[t._id]=!1}})}static \u0275fac=function(r){return new(r||i)(a(u),a(d),a(m),a(h))};static \u0275prov=n({token:i,factory:i.\u0275fac,providedIn:"root"})};var v=class i{constructor(t){this.http=t}getAllProducts(){return this.http.get(s.apiUrl+"products")}getProductId(t){return this.http.get(s.apiUrl+"products/"+t)}getWishList(t){return this.http.get(s.apiUrl+"wishlist/"+t)}static \u0275fac=function(r){return new(r||i)(a(p))};static \u0275prov=n({token:i,factory:i.\u0275fac,providedIn:"root"})};export{f as a,v as b};
