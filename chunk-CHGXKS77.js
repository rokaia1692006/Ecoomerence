import{b as T,c as d,d as R,e as L,f as y,g,h as A,i as I,j as k,k as q,m as G,n as D}from"./chunk-O3DDNPJU.js";import{a as V}from"./chunk-KQUAVRFU.js";import"./chunk-WXWXYMIB.js";import{a as N}from"./chunk-C73HAMVH.js";import{k as E,l as F}from"./chunk-6WQU6EZD.js";import{l as P}from"./chunk-ISIAGV3U.js";import{Ab as m,Ib as s,Kb as _,Nb as S,Ra as i,_ as f,ab as C,ea as w,fa as h,fb as u,nb as a,qb as b,tb as o,ub as t,vb as c,yb as v,zb as x}from"./chunk-7YWQNTIB.js";function W(r,n){if(r&1&&(o(0,"div",9),s(1),t(),o(2,"div",10)(3,"a",11),s(4," Register "),t()()),r&2){let e=m(2);i(),_(" ",e.apiError," ")}}function j(r,n){if(r&1){let e=v();o(0,"form",2),x("ngSubmit",function(){w(e);let p=m();return h(p.getValues())}),o(1,"h1",3),s(2,"Forget Password"),t(),o(3,"div",4)(4,"label",5),s(5,"Email"),t(),c(6,"input",6),S(7),c(8,"app-errormsg",7),t(),o(9,"button",8),s(10,"Submit"),t(),u(11,W,5,1),t()}if(r&2){let e=m();a("formGroup",e.ForgetPass);let l=e.ForgetPass.controls.email;i(8),a("control",l),i(),a("disabled",e.ForgetPass.invalid||e.sucess),i(2),b(e.apiError?11:-1)}}function $(r,n){if(r&1&&(o(0,"div",9),s(1),t()),r&2){let e=m(2);i(),_(" ",e.apiError," ")}}function z(r,n){if(r&1){let e=v();o(0,"form",2),x("ngSubmit",function(){w(e);let p=m();return h(p.verify())}),o(1,"h1",3),s(2,"Enter Code"),t(),o(3,"div",4)(4,"label",12),s(5,"Type reset code"),t(),c(6,"input",13),t(),o(7,"button",8),s(8,"Submit"),t(),u(9,$,2,1,"div",9),t()}if(r&2){let e=m();a("formGroup",e.VerifyPass),i(7),a("disabled",e.VerifyPass.invalid),i(2),b(e.apiError?9:-1)}}function B(r,n){if(r&1&&(o(0,"div",9),s(1),t()),r&2){let e=m(2);i(),_(" ",e.apiError," ")}}function H(r,n){if(r&1){let e=v();o(0,"form",2),x("ngSubmit",function(){w(e);let p=m();return h(p.verifyNewPass())}),o(1,"h1",3),s(2,"Enter New Password "),t(),o(3,"div",4)(4,"label",5),s(5,"Email"),t(),c(6,"input",6),S(7),c(8,"app-errormsg",7),t(),o(9,"div",4)(10,"label",14),s(11,"New password"),t(),c(12,"input",15),S(13),c(14,"app-errormsg",16),t(),o(15,"button",8),s(16,"Submit"),t(),u(17,B,2,1,"div",9),t()}if(r&2){let e=m();a("formGroup",e.NewPass);let l=e.NewPass.controls.email;i(8),a("control",l);let p=e.NewPass.controls.newpassword;i(6),a("control",p),i(),a("disabled",e.NewPass.invalid),i(2),b(e.apiError?17:-1)}}var M=class r{loaderService=f(N);sucess=!1;apiError=null;verified=null;router=f(E);authService=f(V);ForgetPass=new y({email:new g("",[d.required,d.maxLength(50),d.email])});VerifyPass=new y({ResetCode:new g("",[d.required,d.pattern(/^\d+$/)])});NewPass=new y({email:new g("",[d.required,d.maxLength(50),d.email]),newpassword:new g("",[d.required,d.minLength(8)])});verify(){if(this.loaderService.show(),this.VerifyPass.valid){let n={resetCode:this.VerifyPass.get("ResetCode")?.value};this.authService.ResetCode(n).subscribe({next:e=>{e.status?.toLowerCase()==="success"?(this.VerifyPass.reset(),this.verified=!0,this.loaderService.hide()):(this.loaderService.hide(),console.log("yarabbbb"),console.log(e),this.apiError="Something Went Wrong")},error:e=>{console.log(e.errors),this.loaderService.hide(),this.apiError=e.error?.message||"Invalid Code, Try Again"}})}else this.loaderService.hide(),this.VerifyPass.markAllAsTouched()}verifyNewPass(){if(this.loaderService.show(),this.NewPass.valid){let n={email:this.NewPass.get("email")?.value,newPassword:this.NewPass.get("newpassword")?.value};this.authService.ResetPass(n).subscribe({next:e=>{e.status?.toLowerCase()==="success"||e.statusMsg?.toLowerCase()==="success"||e.token!=null?(this.NewPass.reset(),this.router.navigate(["/login"]).then(()=>{this.loaderService.hide()})):(this.loaderService.hide(),console.log("yarabbbb"),console.log(e),this.apiError="Something Went Wrong")},error:e=>{console.log(e.errors),this.loaderService.hide(),this.apiError=e.error?.message||"Invalid Code, Try Again"}})}else this.loaderService.hide(),this.NewPass.markAllAsTouched()}getValues(){if(this.loaderService.show(),this.ForgetPass.valid){let n={email:this.ForgetPass.get("email")?.value};this.authService.forgetPass(n).subscribe({next:e=>{console.log("wth",e),e.statusMsg?.toLowerCase()==="success"||e.message?.toLowerCase().includes("reset code")?(this.ForgetPass.reset(),this.sucess=!0,this.loaderService.hide()):(this.loaderService.hide(),this.apiError="Invalid response, try again")},error:e=>{this.loaderService.hide(),console.error("FAILED",e.error),this.apiError=e.error?.message||"Try Again"}})}else this.loaderService.hide(),console.log(this.ForgetPass.errors),this.ForgetPass.markAllAsTouched()}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=C({type:r,selectors:[["app-forget-password"]],decls:4,vars:3,consts:[[1,"pt-10"],["class","max-w-sm mx-auto p-6 rounded-lg shadow-lg shadow-cyan-300 border-solid  border-slate-500 m-5",3,"formGroup","ngSubmit",4,"ngIf"],[1,"max-w-sm","mx-auto","p-6","rounded-lg","shadow-lg","shadow-cyan-300","border-solid","border-slate-500","m-5",3,"ngSubmit","formGroup"],[1,"mb-5","text-center","font-bold","text-2xl"],[1,"mb-5"],["for","email",1,"block","mb-2","text-sm","font-medium","text-gray-900"],["formControlName","email","type","email","id","email","placeholder","Email","required","",1,"bg-white","border","border-gray-300","text-gray-900","text-sm","rounded-lg","focus:ring-green-500","focus:border-green-500","block","w-full","p-2.5"],["label","Email",3,"control"],["type","submit",1,"disabled:bg-gray-400","disabled:cursor-not-allowed","disabled:hover:bg-slate-800","disabled:focus:ring-0","text-white","bg-green-600","hover:bg-green-700","focus:ring-2","font-medium","rounded-lg","text-sm","w-full","sm:w-auto","px-5","py-2.5","text-center",3,"disabled"],[1,"text-red-600","font-mono","font-medium","mt-3","mb-3","text-center"],[1,"justify-center","text-center","text-white","font-extrabold","rounded-md","p-2","m-5","bg-green-700","hover:bg-green-600"],["routerLink","/register"],["for","Resetcode",1,"block","mb-2","text-sm","font-medium","text-gray-900"],["formControlName","ResetCode","type","text","id","ResetCode","placeholder","Reset Code","required","",1,"bg-white","border","border-gray-300","text-gray-900","text-sm","rounded-lg","focus:ring-green-500","focus:border-green-500","block","w-full","p-2.5"],["for","newpassword",1,"block","mb-2","text-sm","font-medium","text-gray-900"],["formControlName","newpassword","type","password","id","newpassword","required","",1,"bg-white","border","border-gray-300","text-gray-900","text-sm","rounded-lg","focus:ring-green-500","focus:border-green-500","block","w-full","p-2.5"],["label","Password",3,"control"]],template:function(e,l){e&1&&(o(0,"section",0),u(1,j,12,4,"form",1)(2,z,10,3,"form",1)(3,H,18,5,"form",1),t()),e&2&&(i(),a("ngIf",!l.sucess&&!l.verified),i(),a("ngIf",l.sucess&&!l.verified),i(),a("ngIf",l.verified))},dependencies:[G,A,T,R,L,q,I,k,P,D,F],encapsulation:2})};export{M as ForgetPasswordComponent};
